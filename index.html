<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sabores Express â€“ Enero 2025</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #C9941A; --gold-light: #F5B931;
    --red: #C0392B;  --red-light: #E74C3C;
    --green: #27AE60; --green-light: #2ECC71;
    --dark: #181818; --surface: #222; --surface2: #2A2A2A; --surface3: #333;
    --text: #F0EDE8; --muted: #777; --radius: 16px;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--dark); color:var(--text); font-family:'DM Sans',sans-serif; min-height:100vh; }
  body::before {
    content:''; position:fixed; inset:0; pointer-events:none; z-index:0;
    background: radial-gradient(ellipse at 15% 10%, rgba(201,148,26,.08) 0%, transparent 55%),
                radial-gradient(ellipse at 85% 90%, rgba(192,57,43,.06) 0%, transparent 55%);
  }
  .container { max-width:1280px; margin:0 auto; padding:36px 24px 60px; position:relative; z-index:1; }

  /* HEADER */
  .header {
    display:flex; align-items:center; justify-content:space-between;
    margin-bottom:32px; animation:fadeDown .6s ease both;
  }
  .brand { display:flex; align-items:center; gap:16px; }
  .logo-circle {
    width:58px; height:58px; border-radius:50%;
    background:linear-gradient(135deg,var(--gold),var(--gold-light));
    display:flex; align-items:center; justify-content:center;
    font-family:'Bebas Neue',sans-serif; font-size:10px; letter-spacing:1px;
    color:var(--dark); text-align:center; line-height:1.2;
    box-shadow:0 0 28px rgba(201,148,26,.35);
  }
  .header-titles h1 { font-family:'Bebas Neue',sans-serif; font-size:2.2rem; letter-spacing:3px; color:var(--gold-light); line-height:1; }
  .header-titles p  { font-size:.75rem; color:var(--muted); letter-spacing:2px; text-transform:uppercase; margin-top:4px; }
  .period-badge {
    background:var(--surface2); border:1px solid rgba(201,148,26,.3);
    border-radius:10px; padding:10px 20px; text-align:right;
  }
  .period-badge .label { font-size:.68rem; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; }
  .period-badge .val   { font-family:'Bebas Neue',sans-serif; font-size:1.6rem; color:var(--gold-light); letter-spacing:2px; }

  .accent-line { height:2px; background:linear-gradient(90deg,var(--gold),transparent); border-radius:2px; width:80px; margin-bottom:28px; }

  /* TABS */
  .tabs { display:flex; gap:8px; margin-bottom:28px; flex-wrap:wrap; animation:fadeUp .4s ease .05s both; }
  .tab {
    background:var(--surface2); border:1px solid rgba(255,255,255,.07);
    border-radius:99px; padding:8px 20px; font-size:.82rem;
    cursor:pointer; transition:all .2s; color:var(--muted); user-select:none;
  }
  .tab:hover { color:var(--text); border-color:rgba(201,148,26,.3); }
  .tab.active { background:rgba(201,148,26,.18); border-color:var(--gold); color:var(--gold-light); font-weight:700; }

  /* KPI ROW */
  .kpi-row { display:grid; grid-template-columns:repeat(4,1fr); gap:16px; margin-bottom:20px; animation:fadeUp .5s ease .1s both; }
  .kpi-card {
    border-radius:var(--radius); padding:24px 20px;
    position:relative; overflow:hidden; transition:transform .2s;
  }
  .kpi-card:hover { transform:translateY(-3px); }
  .kpi-card.altas  { background:linear-gradient(135deg,rgba(201,148,26,.14),rgba(245,185,49,.03)); border:1px solid rgba(201,148,26,.4); }
  .kpi-card.bajas  { background:linear-gradient(135deg,rgba(192,57,43,.14),rgba(231,76,60,.03));  border:1px solid rgba(192,57,43,.4); }
  .kpi-card.locales{ background:linear-gradient(135deg,rgba(255,255,255,.05),rgba(255,255,255,.01)); border:1px solid rgba(255,255,255,.1); }
  .kpi-card.neto   { background:linear-gradient(135deg,rgba(39,174,96,.14),rgba(46,204,113,.03)); border:1px solid rgba(39,174,96,.4); }
  .kpi-label { font-size:.68rem; text-transform:uppercase; letter-spacing:2px; color:var(--muted); margin-bottom:6px; }
  .kpi-number { font-family:'Bebas Neue',sans-serif; font-size:3.8rem; line-height:1; letter-spacing:2px; transition:all .4s; }
  .kpi-card.altas  .kpi-number { color:var(--gold-light); }
  .kpi-card.bajas  .kpi-number { color:var(--red-light); }
  .kpi-card.locales .kpi-number { color:var(--text); }
  .kpi-card.neto   .kpi-number { color:var(--green-light); }
  .kpi-sub  { font-size:.72rem; color:var(--muted); margin-top:4px; }
  .kpi-icon { position:absolute; bottom:16px; right:18px; font-size:2rem; opacity:.2; }

  /* SECTION TITLE */
  .section-title { font-family:'Bebas Neue',sans-serif; font-size:1.1rem; letter-spacing:2px; color:var(--muted); margin-bottom:14px; text-transform:uppercase; }

  /* REGIONAL CARDS */
  .regional-row { display:grid; grid-template-columns:repeat(5,1fr); gap:14px; margin-bottom:28px; animation:fadeUp .5s ease .15s both; }
  .reg-card {
    background:var(--surface2); border:1px solid rgba(255,255,255,.07);
    border-radius:14px; padding:18px 16px; cursor:pointer;
    transition:all .25s; position:relative; overflow:hidden;
  }
  .reg-card:hover  { transform:translateY(-3px); border-color:rgba(201,148,26,.4); }
  .reg-card.active { background:rgba(201,148,26,.14); border-color:var(--gold); }
  .reg-card::before { content:''; position:absolute; inset:0; border-radius:14px; opacity:0; transition:opacity .25s; background:linear-gradient(135deg,rgba(201,148,26,.12),transparent); }
  .reg-card.active::before { opacity:1; }
  .reg-name  { font-size:.72rem; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:10px; line-height:1.3; }
  .reg-card.active .reg-name { color:var(--gold-light); }
  .reg-stats { display:flex; gap:10px; }
  .reg-stat  { flex:1; }
  .reg-stat .rs-label { font-size:.6rem; color:var(--muted); text-transform:uppercase; letter-spacing:1px; }
  .reg-stat .rs-val   { font-family:'Bebas Neue',sans-serif; font-size:1.6rem; line-height:1.1; }
  .rs-val.g { color:var(--gold-light); }
  .rs-val.r { color:var(--red-light); }

  /* MAIN CONTENT */
  .main-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px; animation:fadeUp .5s ease .2s both; }

  .chart-card { background:var(--surface); border-radius:var(--radius); padding:24px; border:1px solid rgba(255,255,255,.06); }
  .chart-title { font-family:'Bebas Neue',sans-serif; font-size:1.15rem; letter-spacing:2px; margin-bottom:18px; display:flex; align-items:center; gap:8px; }
  .chart-title.gold { color:var(--gold-light); }
  .chart-title.red  { color:var(--red-light); }
  .chart-title.mixed { color:var(--text); }

  /* BAR */
  .bar-group { margin-bottom:11px; }
  .bar-meta  { display:flex; justify-content:space-between; margin-bottom:5px; font-size:.78rem; }
  .bar-name  { color:var(--text); font-weight:500; max-width:65%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .bar-val   { font-weight:700; }
  .bar-val.gold { color:var(--gold-light); }
  .bar-val.red  { color:var(--red-light); }
  .bar-track { background:rgba(255,255,255,.06); border-radius:99px; height:9px; overflow:hidden; cursor:pointer; }
  .bar-fill  { height:100%; border-radius:99px; width:0; transition:width 1s cubic-bezier(.4,0,.2,1); }
  .bar-fill.gold  { background:linear-gradient(90deg,var(--gold),var(--gold-light)); }
  .bar-fill.red   { background:linear-gradient(90deg,var(--red),var(--red-light)); }
  .bar-fill.green { background:linear-gradient(90deg,var(--green),var(--green-light)); }
  .bar-group:hover .bar-fill { filter:brightness(1.2); }

  /* LOCALES TABLE */
  .table-card { background:var(--surface); border-radius:var(--radius); padding:24px; border:1px solid rgba(255,255,255,.06); animation:fadeUp .5s ease .25s both; }
  .table-search {
    width:100%; background:var(--surface2); border:1px solid rgba(255,255,255,.08);
    border-radius:8px; padding:9px 14px; color:var(--text); font-size:.82rem;
    margin-bottom:16px; outline:none; font-family:inherit;
    transition:border-color .2s;
  }
  .table-search:focus { border-color:rgba(201,148,26,.5); }
  .table-search::placeholder { color:var(--muted); }

  table { width:100%; border-collapse:collapse; font-size:.8rem; }
  thead th { text-align:left; font-size:.65rem; text-transform:uppercase; letter-spacing:1.5px; color:var(--muted); padding:0 10px 10px; border-bottom:1px solid rgba(255,255,255,.08); }
  tbody tr { border-bottom:1px solid rgba(255,255,255,.04); transition:background .15s; cursor:default; }
  tbody tr:hover { background:rgba(255,255,255,.03); }
  td { padding:9px 10px; color:var(--text); }
  td.estado-apertura { color:var(--gold-light); font-size:.7rem; font-weight:700; text-transform:uppercase; letter-spacing:1px; }
  td.estado-activo   { color:var(--muted); font-size:.7rem; }
  td.num-altas { color:var(--gold-light); font-weight:700; text-align:right; }
  td.num-bajas { color:var(--red-light);  font-weight:700; text-align:right; }
  td.num-neto  { font-weight:700; text-align:right; }
  td.num-neto.pos { color:var(--green-light); }
  td.num-neto.neg { color:var(--red-light); }
  td.num-neto.zer { color:var(--muted); }
  .no-results { text-align:center; padding:24px; color:var(--muted); font-size:.82rem; }

  /* TOOLTIP */
  .tooltip {
    position:fixed; z-index:999; background:var(--surface3);
    border:1px solid rgba(255,255,255,.12); border-radius:10px;
    padding:10px 16px; font-size:.82rem; pointer-events:none;
    opacity:0; transform:translateY(4px); transition:opacity .15s,transform .15s;
    box-shadow:0 8px 24px rgba(0,0,0,.4); white-space:nowrap;
  }
  .tooltip.visible { opacity:1; transform:translateY(0); }
  .tt-name { font-weight:700; margin-bottom:3px; }
  .tt-row  { color:var(--muted); font-size:.78rem; }

  /* FOOTER */
  .footer { margin-top:40px; text-align:center; font-size:.7rem; color:var(--muted); letter-spacing:1.5px; text-transform:uppercase; }

  /* ANIMATIONS */
  @keyframes fadeDown { from{opacity:0;transform:translateY(-20px)} to{opacity:1;transform:translateY(0)} }
  @keyframes fadeUp   { from{opacity:0;transform:translateY(24px)}  to{opacity:1;transform:translateY(0)} }

  @media(max-width:900px) {
    .kpi-row { grid-template-columns:repeat(2,1fr); }
    .regional-row { grid-template-columns:repeat(2,1fr); }
    .main-grid { grid-template-columns:1fr; }
  }
  @media(max-width:580px) {
    .header { flex-direction:column; gap:14px; }
    .kpi-row { grid-template-columns:1fr 1fr; }
  }
</style>
</head>
<body>

<div class="tooltip" id="tooltip">
  <div class="tt-name" id="tt-name"></div>
  <div class="tt-row"  id="tt-a"></div>
  <div class="tt-row"  id="tt-b"></div>
  <div class="tt-row"  id="tt-l"></div>
</div>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="brand">
      <div class="logo-circle">SABORES<br>EXPRESS</div>
      <div class="header-titles">
        <h1>Dashboard de Personal</h1>
        <p>Altas Â· Bajas Â· Locales Â· Enero 2025</p>
      </div>
    </div>
    <div class="period-badge">
      <div class="label">PerÃ­odo</div>
      <div class="val">Enero 2025</div>
    </div>
  </div>

  <div class="accent-line"></div>

  <!-- TABS -->
  <div class="tabs">
    <div class="tab active" data-tab="resumen">ğŸ“Š Resumen General</div>
    <div class="tab" data-tab="zonales">ğŸ‘¥ Por Gerente Zonal</div>
    <div class="tab" data-tab="locales">ğŸª Por Local</div>
  </div>

  <!-- KPIs -->
  <div class="kpi-row">
    <div class="kpi-card altas">
      <div class="kpi-label">Altas Totales</div>
      <div class="kpi-number" id="kpi-altas">231</div>
      <div class="kpi-sub"  id="kpi-altas-sub">Todas las regiones</div>
      <div class="kpi-icon">ğŸ“ˆ</div>
    </div>
    <div class="kpi-card bajas">
      <div class="kpi-label">Bajas Totales</div>
      <div class="kpi-number" id="kpi-bajas">138</div>
      <div class="kpi-sub"  id="kpi-bajas-sub">Todas las regiones</div>
      <div class="kpi-icon">ğŸ“‰</div>
    </div>
    <div class="kpi-card neto">
      <div class="kpi-label">Neto (Altas âˆ’ Bajas)</div>
      <div class="kpi-number" id="kpi-neto">+93</div>
      <div class="kpi-sub"  id="kpi-neto-sub">Balance del perÃ­odo</div>
      <div class="kpi-icon">âš–ï¸</div>
    </div>
    <div class="kpi-card locales">
      <div class="kpi-label">Locales Activos</div>
      <div class="kpi-number" id="kpi-locales">142</div>
      <div class="kpi-sub"  id="kpi-locales-sub">5 regiones Â· 28 zonales</div>
      <div class="kpi-icon">ğŸª</div>
    </div>
  </div>

  <!-- REGIONALES -->
  <div class="section-title" id="reg-section-title">Gerentes Regionales â€” clic para filtrar</div>
  <div class="regional-row" id="reg-cards"></div>

  <!-- CONTENIDO POR TAB -->
  <div id="tab-resumen">
    <div class="main-grid">
      <div class="chart-card">
        <div class="chart-title gold">ğŸ“Š Altas por Zonal</div>
        <div id="chart-altas-zonal"></div>
      </div>
      <div class="chart-card">
        <div class="chart-title red">ğŸ“Š Bajas por Zonal</div>
        <div id="chart-bajas-zonal"></div>
      </div>
    </div>
  </div>

  <div id="tab-zonales" style="display:none">
    <div class="chart-card" style="margin-bottom:20px">
      <div class="chart-title mixed">âš¡ Neto por Gerente Zonal (Altas âˆ’ Bajas)</div>
      <div id="chart-neto-zonal"></div>
    </div>
  </div>

  <div id="tab-locales" style="display:none">
    <div class="table-card">
      <input class="table-search" id="search-locales" placeholder="ğŸ”  Buscar local, zonal o regionalâ€¦" />
      <div id="table-locales"></div>
    </div>
  </div>

  <div class="footer">Sabores Express Â· Artesanos del Sabor Â· Reporte Interno RR.HH. Â· Enero 2025</div>
</div>

<script>
// â”€â”€ RAW DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const RAW = [
  ["Mauro Dalla Valle","Greisnell MejÃ­as","Activo","Boedo",0,1],
  ["Mauro Dalla Valle","Greisnell MejÃ­as","Activo","OlazÃ¡bal",4,0],
  ["Mauro Dalla Valle","Greisnell MejÃ­as","Activo","Monroe",0,0],
  ["Mauro Dalla Valle","Greisnell MejÃ­as","Activo","Entre RÃ­os",0,1],
  ["Mauro Dalla Valle","Emanuel Mazueco","Activo","Lomas de Zamora 1",0,3],
  ["Mauro Dalla Valle","Emanuel Mazueco","Activo","Lomas de Zamora 2",0,1],
  ["Mauro Dalla Valle","Emanuel Mazueco","Activo","Lomas de Zamora 3",0,2],
  ["Mauro Dalla Valle","Emanuel Mazueco","Activo","Lomas de Zamora 4",0,0],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Activo","Corrientes 1",0,1],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Activo","Corrientes 2",0,1],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Activo","Corrientes 3",3,4],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Apertura","Corrientes 4",3,0],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Activo","PueyrredÃ³n 1",1,1],
  ["Mauro Dalla Valle","MarÃ­a Laura GÃ³mez","Apertura","PueyrredÃ³n 2",4,0],
  ["Mauro Dalla Valle","Ezequiel Acosta","Activo","Liniers 1",1,1],
  ["Mauro Dalla Valle","Ezequiel Acosta","Activo","Liniers 2",1,2],
  ["Mauro Dalla Valle","Ezequiel Acosta","Activo","Liniers 3",0,0],
  ["Mauro Dalla Valle","Ezequiel Acosta","Activo","Pompeya",0,0],
  ["Mauro Dalla Valle","Gabriela Ferreyra","Activo","Caballito 1",0,0],
  ["Mauro Dalla Valle","Gabriela Ferreyra","Activo","Caballito 2",0,2],
  ["Mauro Dalla Valle","Gabriela Ferreyra","Activo","Chilavert",0,1],
  ["Mauro Dalla Valle","Gabriela Ferreyra","Activo","Flores",0,1],
  ["Mauro Dalla Valle","Douglas Seprum","Activo","Lavalle",5,3],
  ["Mauro Dalla Valle","Douglas Seprum","Activo","Lavalle 2",0,0],
  ["Mauro Dalla Valle","Douglas Seprum","Activo","TucumÃ¡n",0,1],
  ["Mauro Dalla Valle","Douglas Seprum","Activo","Florida",0,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Activo","Boulogne",5,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Activo","JosÃ© LeÃ³n Suarez",1,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Activo","Munro",0,3],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Activo","Pte. Saavedra",5,3],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Apertura","Olivos",6,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Apertura","MartÃ­nez",0,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Apertura","Villa Adelina",6,0],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Activo","Vicente LÃ³pez",1,1],
  ["Marcelo Biurra","VerÃ³nica GonzÃ¡lez","Apertura","Vicente LÃ³pez 2",0,0],
  ["Marcelo Biurra","Camila Almeida","Activo","Benavidez",4,0],
  ["Marcelo Biurra","Camila Almeida","Activo","San Isidro",2,1],
  ["Marcelo Biurra","Camila Almeida","Activo","San Isidro 2",0,1],
  ["Marcelo Biurra","Camila Almeida","Activo","San Fernando",3,0],
  ["Marcelo Biurra","Camila Almeida","Activo","Virreyes",1,1],
  ["Marcelo Biurra","Camila Almeida","Activo","Tigre",7,5],
  ["Marcelo Biurra","Ronaldo Arguello","Activo","Escobar",5,8],
  ["Marcelo Biurra","Ronaldo Arguello","Apertura","Escobar 2",0,0],
  ["Marcelo Biurra","Ronaldo Arguello","Activo","Maschwitz",1,1],
  ["Marcelo Biurra","Ronaldo Arguello","Apertura","GarÃ­n",10,0],
  ["Marcelo Biurra","Ronaldo Arguello","Activo","Zarate",3,0],
  ["Marcelo Biurra","Sofia d Antuono","Activo","Talar",1,0],
  ["Marcelo Biurra","Sofia d Antuono","Activo","Pacheco 1",1,2],
  ["Marcelo Biurra","Sofia d Antuono","Activo","Pacheco 2",0,1],
  ["Marcelo Biurra","Sofia d Antuono","Activo","Maquinista Savio",3,0],
  ["Marcelo Biurra","Nahuel SÃ¡nchez","Activo","Villa Ballester 1",5,1],
  ["Marcelo Biurra","Nahuel SÃ¡nchez","Activo","Villa Ballester 2",4,3],
  ["Marcelo Biurra","Nahuel SÃ¡nchez","Activo","San MartÃ­n 1",1,2],
  ["Marcelo Biurra","Nahuel SÃ¡nchez","Activo","San MartÃ­n 2",2,0],
  ["Marcelo Biurra","AylÃ©n Ponce / Giovanna Solerez","Activo","Rosario 1",3,0],
  ["Marcelo Biurra","AylÃ©n Ponce / Giovanna Solerez","Activo","Rosario 2",3,0],
  ["Marcelo Biurra","AylÃ©n Ponce / Giovanna Solerez","Activo","Rosario 3",4,2],
  ["Marcelo Biurra","AylÃ©n Ponce / Giovanna Solerez","Activo","San Nicolas",4,0],
  ["Lucia Velez","Renata Fedullo","Activo","Ramos MejÃ­a 1",6,2],
  ["Lucia Velez","Renata Fedullo","Activo","Ramos MejÃ­a 2",2,3],
  ["Lucia Velez","Renata Fedullo","Activo","Ramos MejÃ­a 3",0,0],
  ["Lucia Velez","Renata Fedullo","Activo","Haedo",1,3],
  ["Lucia Velez","Malena Aguera","Activo","Moreno 1",0,0],
  ["Lucia Velez","Malena Aguera","Activo","Moreno 2",0,2],
  ["Lucia Velez","Malena Aguera","Activo","Gral. RodrÃ­guez",3,0],
  ["Lucia Velez","Malena Aguera","Activo","Lujan",1,2],
  ["Lucia Velez","Pablo Figueroa","Activo","Merlo 1",4,0],
  ["Lucia Velez","Pablo Figueroa","Activo","Merlo 2",3,0],
  ["Lucia Velez","Pablo Figueroa","Activo","Merlo 3",0,0],
  ["Lucia Velez","Pablo Figueroa","Activo","Padua",2,0],
  ["Lucia Velez","Pablo Figueroa","Activo","Rafael Castillo",3,0],
  ["Lucia Velez","Pablo Muga","Activo","MorÃ³n 1",0,0],
  ["Lucia Velez","Pablo Muga","Activo","MorÃ³n 2",0,0],
  ["Lucia Velez","Pablo Muga","Activo","MorÃ³n 3",0,0],
  ["Lucia Velez","Pablo Muga","Activo","MorÃ³n 4",0,1],
  ["Lucia Velez","Pablo Muga","Activo","MorÃ³n 5",2,1],
  ["Gustavo Cabrera","Pamela Maidana","Activo","Caseros 1",4,3],
  ["Gustavo Cabrera","Pamela Maidana","Activo","Caseros 2",3,1],
  ["Gustavo Cabrera","Pamela Maidana","Activo","Hurlingham 1",1,1],
  ["Gustavo Cabrera","Pamela Maidana","Activo","Hurlingham 2",2,1],
  ["Gustavo Cabrera","Pamela Maidana","Activo","El Palomar",3,1],
  ["Gustavo Cabrera","Pamela Maidana","Activo","Santos Lugares",1,1],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","Pilar 1",3,1],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","Pilar 2",2,0],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","JosÃ© C Paz 1",0,0],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","JosÃ© C Paz 2",4,1],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","Del Viso",4,3],
  ["Gustavo Cabrera","Marianella YÃ±iguez","Activo","Manuel Alberti",1,0],
  ["Gustavo Cabrera","Camila Fredes","Activo","Bella Vista",3,0],
  ["Gustavo Cabrera","Camila Fredes","Activo","Cruce Castelar",1,1],
  ["Gustavo Cabrera","Camila Fredes","Activo","Loma Hermosa",2,0],
  ["Gustavo Cabrera","Camila Fredes","Activo","San Miguel 1",2,2],
  ["Gustavo Cabrera","Camila Fredes","Activo","San Miguel 2",0,0],
  ["Gustavo Cabrera","Camila Fredes","Activo","San Miguel 3",0,0],
  ["Gustavo Cabrera","Camila Fredes","Activo","William Morris",2,1],
  ["Gustavo Cabrera","Agustina Sussi","Activo","San Justo 1",1,0],
  ["Gustavo Cabrera","Agustina Sussi","Activo","San Justo 2",0,2],
  ["Gustavo Cabrera","Agustina Sussi","Activo","San Justo 3",0,0],
  ["Gustavo Cabrera","Agustina Sussi","Activo","Lomas del Mirador",1,4],
  ["Gustavo Cabrera","Brandon Oliva","Activo","Grand Bourg",0,0],
  ["Gustavo Cabrera","Brandon Oliva","Activo","Don Torcuato",0,0],
  ["Gustavo Cabrera","Brandon Oliva","Activo","Los Polvorines",0,2],
  ["Gustavo Cabrera","Brandon Oliva","Activo","Sourdeaux",0,0],
  ["Gustavo Cabrera","Brandon Oliva","Activo","Tortuguitas",0,0],
  ["Gustavo Cabrera","Tamara Migoya","Activo","Crovara",0,0],
  ["Gustavo Cabrera","Tamara Migoya","Activo","Tapiales",2,1],
  ["Gustavo Cabrera","Tamara Migoya","Activo","Laferrere 1",0,0],
  ["Gustavo Cabrera","Tamara Migoya","Activo","Laferrere 2",0,1],
  ["Agustin Sbampato","Franco Pedrazza","Activo","La Plata 1",0,0],
  ["Agustin Sbampato","Franco Pedrazza","Activo","La Plata 2",1,0],
  ["Agustin Sbampato","Franco Pedrazza","Activo","La Plata 3",0,2],
  ["Agustin Sbampato","Franco Pedrazza","Activo","La Plata 4",0,0],
  ["Agustin Sbampato","Franco Pedrazza","Activo","Lezama",0,0],
  ["Agustin Sbampato","Lujan Brandan","Activo","Mar del Plata 1",5,5],
  ["Agustin Sbampato","Lujan Brandan","Activo","Mar del Plata 2",4,3],
  ["Agustin Sbampato","Lujan Brandan","Activo","Mar del Plata 3",6,3],
  ["Agustin Sbampato","Lujan Brandan","Activo","Mar del Plata 4",4,3],
  ["Agustin Sbampato","Lujan Brandan","Activo","Mar del Plata 5",4,3],
  ["Agustin Sbampato","Michelle Ãlvarez","Apertura","AdroguÃ©",0,0],
  ["Agustin Sbampato","Michelle Ãlvarez","Activo","El JagÃ¼el",1,1],
  ["Agustin Sbampato","Michelle Ãlvarez","Activo","Monte grande",3,6],
  ["Agustin Sbampato","Michelle Ãlvarez","Apertura","Monte grande 2",14,0],
  ["Agustin Sbampato","Michelle Ãlvarez","Apertura","Ezeiza",0,0],
  ["Agustin Sbampato","Michelle Ãlvarez","Activo","TristÃ¡n Suarez",0,3],
  ["Agustin Sbampato","Tomas Moreno","Activo","Banfield",0,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","Temperley 1",0,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","Temperley 2",0,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","LanÃºs 2",0,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","LanÃºs 3",1,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","Glew",0,0],
  ["Agustin Sbampato","Tomas Moreno","Activo","Gerli",0,0],
  ["Agustin Sbampato","Magali Sandoval","Activo","Berazategui 1",1,0],
  ["Agustin Sbampato","Magali Sandoval","Activo","Berazategui 2",0,0],
  ["Agustin Sbampato","Magali Sandoval","Activo","Solano",0,0],
  ["Agustin Sbampato","Magali Sandoval","Activo","Varela 1",1,0],
  ["Agustin Sbampato","Magali Sandoval","Apertura","Varela 2",0,0],
  ["Agustin Sbampato","Magali Sandoval","Apertura","Cruce Varela",0,0],
  ["Agustin Sbampato","Camila Carranza","Activo","Claypole",0,2],
  ["Agustin Sbampato","Camila Carranza","Activo","Quilmes 1",0,1],
  ["Agustin Sbampato","Camila Carranza","Activo","Quilmes 2",1,1],
  ["Agustin Sbampato","Camila Carranza","Activo","Quilmes 3",0,1],
  ["Agustin Sbampato","Camila Carranza","Activo","Wilde",3,2],
];

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let activeGR = null; // null = all

// â”€â”€ AGGREGATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function agg(data) {
  const byGR = {}, byGZ = {};
  data.forEach(([gr,gz,est,loc,a,b]) => {
    if (!byGR[gr]) byGR[gr] = {altas:0,bajas:0,locales:0,zonales:new Set()};
    byGR[gr].altas += a; byGR[gr].bajas += b; byGR[gr].locales++;
    byGR[gr].zonales.add(gz);
    if (!byGZ[gz]) byGZ[gz] = {altas:0,bajas:0,locales:0,gr};
    byGZ[gz].altas += a; byGZ[gz].bajas += b; byGZ[gz].locales++;
  });
  return {byGR, byGZ};
}

function filtered() { return activeGR ? RAW.filter(r => r[0]===activeGR) : RAW; }

// â”€â”€ TOOLTIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const tooltip = document.getElementById('tooltip');
document.addEventListener('mousemove', e => {
  tooltip.style.left = (e.clientX+14)+'px';
  tooltip.style.top  = (e.clientY-50)+'px';
});
function showTT(name, a, b, extra='') {
  document.getElementById('tt-name').textContent = name;
  document.getElementById('tt-a').textContent = `Altas: ${a}`;
  document.getElementById('tt-b').textContent = `Bajas: ${b}`;
  document.getElementById('tt-l').textContent = extra;
  tooltip.classList.add('visible');
}
function hideTT() { tooltip.classList.remove('visible'); }

// â”€â”€ RENDER BARS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderBars(containerId, items, colorClass, labelKey='name', valKey='val', showNeto=false) {
  const container = document.getElementById(containerId);
  if (!items.length) { container.innerHTML='<p style="color:var(--muted);font-size:.8rem">Sin datos</p>'; return; }
  const maxAbs = Math.max(...items.map(i => Math.abs(i[valKey])), 1);
  container.innerHTML = '';
  items.forEach(item => {
    const v = item[valKey]; const pct = Math.abs(v)/maxAbs*100;
    let cc = colorClass;
    if (showNeto) cc = v > 0 ? 'green' : v < 0 ? 'red' : 'gold';
    const sign = showNeto && v > 0 ? '+' : '';
    const g = document.createElement('div'); g.className='bar-group';
    g.innerHTML=`<div class="bar-meta"><span class="bar-name">${item[labelKey]}</span><span class="bar-val ${cc}">${sign}${v}</span></div>
      <div class="bar-track"><div class="bar-fill ${cc}" data-pct="${pct}"></div></div>`;
    g.querySelector('.bar-track').addEventListener('mouseenter', () => showTT(item[labelKey], item.altas??v, item.bajas??'â€”', item.locales?`Locales: ${item.locales}`:''));
    g.querySelector('.bar-track').addEventListener('mouseleave', hideTT);
    container.appendChild(g);
  });
  setTimeout(() => container.querySelectorAll('.bar-fill').forEach(el => el.style.width = el.dataset.pct+'%'), 60);
}

// â”€â”€ RENDER REGIONAL CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderRegionalCards() {
  const {byGR} = agg(RAW); // always all for cards
  const wrap = document.getElementById('reg-cards');
  wrap.innerHTML = '';

  // "Todos" card
  const all = document.createElement('div');
  all.className = 'reg-card' + (activeGR===null ? ' active' : '');
  all.innerHTML = `<div class="reg-name">ğŸŒ Todas las Regiones</div>
    <div class="reg-stats">
      <div class="reg-stat"><div class="rs-label">Altas</div><div class="rs-val g">231</div></div>
      <div class="reg-stat"><div class="rs-label">Bajas</div><div class="rs-val r">138</div></div>
    </div>`;
  all.addEventListener('click', () => { activeGR = null; refresh(); });
  wrap.appendChild(all);

  Object.entries(byGR).forEach(([gr, d]) => {
    const c = document.createElement('div');
    c.className = 'reg-card' + (activeGR===gr ? ' active' : '');
    const initials = gr.split(' ').map(w=>w[0]).join('').slice(0,2).toUpperCase();
    c.innerHTML = `<div class="reg-name">${initials} Â· ${gr.split(' ')[0]} ${gr.split(' ').slice(-1)}</div>
      <div class="reg-stats">
        <div class="reg-stat"><div class="rs-label">Altas</div><div class="rs-val g">${d.altas}</div></div>
        <div class="reg-stat"><div class="rs-label">Bajas</div><div class="rs-val r">${d.bajas}</div></div>
      </div>`;
    c.addEventListener('mouseenter', () => showTT(gr, d.altas, d.bajas, `Locales: ${d.locales} Â· Zonales: ${d.zonales.size}`));
    c.addEventListener('mouseleave', hideTT);
    c.addEventListener('click', () => { activeGR = activeGR===gr ? null : gr; hideTT(); refresh(); });
    wrap.appendChild(c);
  });
}

// â”€â”€ UPDATE KPIs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateKPIs() {
  const data = filtered();
  const a = data.reduce((s,r)=>s+r[4],0);
  const b = data.reduce((s,r)=>s+r[5],0);
  const neto = a - b;
  const locales = data.length;
  const zonales = new Set(data.map(r=>r[1])).size;

  ['kpi-altas','kpi-bajas','kpi-neto','kpi-locales'].forEach(id => {
    document.getElementById(id).style.opacity = '0';
  });
  setTimeout(() => {
    document.getElementById('kpi-altas').textContent = a;
    document.getElementById('kpi-bajas').textContent = b;
    document.getElementById('kpi-neto').textContent  = (neto>=0?'+':'')+neto;
    document.getElementById('kpi-locales').textContent = locales;
    document.getElementById('kpi-altas-sub').textContent = activeGR ? activeGR : 'Todas las regiones';
    document.getElementById('kpi-bajas-sub').textContent = activeGR ? activeGR : 'Todas las regiones';
    document.getElementById('kpi-neto-sub').textContent  = 'Balance del perÃ­odo';
    document.getElementById('kpi-locales-sub').textContent = `${activeGR||'5 regiones'} Â· ${zonales} zonales`;
    ['kpi-altas','kpi-bajas','kpi-neto','kpi-locales'].forEach(id => document.getElementById(id).style.opacity='1');
  }, 150);
}

// â”€â”€ RENDER CHARTS TAB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderTabResumen() {
  const {byGZ} = agg(filtered());
  const gz_altas = Object.entries(byGZ).map(([n,d])=>({name:n,val:d.altas,altas:d.altas,bajas:d.bajas,locales:d.locales})).sort((a,b)=>b.val-a.val).slice(0,12);
  const gz_bajas = Object.entries(byGZ).map(([n,d])=>({name:n,val:d.bajas,altas:d.altas,bajas:d.bajas,locales:d.locales})).sort((a,b)=>b.val-a.val).slice(0,12);
  renderBars('chart-altas-zonal', gz_altas, 'gold');
  renderBars('chart-bajas-zonal', gz_bajas, 'red');
}

function renderTabZonales() {
  const {byGZ} = agg(filtered());
  const items = Object.entries(byGZ).map(([n,d])=>({name:n,val:d.altas-d.bajas,altas:d.altas,bajas:d.bajas,locales:d.locales})).sort((a,b)=>b.val-a.val);
  renderBars('chart-neto-zonal', items, 'green', 'name', 'val', true);
}

// â”€â”€ RENDER TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderTable(query='') {
  const data = filtered();
  const q = query.toLowerCase();
  const rows = data.filter(r => !q || r[0].toLowerCase().includes(q) || r[1].toLowerCase().includes(q) || r[3].toLowerCase().includes(q));

  if (!rows.length) {
    document.getElementById('table-locales').innerHTML = '<p class="no-results">Sin resultados para esa bÃºsqueda.</p>';
    return;
  }

  const sorted = [...rows].sort((a,b) => (b[4]-b[5]) - (a[4]-a[5]));
  let html = `<table><thead><tr>
    <th>Local</th><th>Estado</th><th>Gerente Zonal</th><th>G. Regional</th>
    <th style="text-align:right">Altas</th><th style="text-align:right">Bajas</th><th style="text-align:right">Neto</th>
  </tr></thead><tbody>`;

  sorted.forEach(([gr,gz,est,loc,a,b]) => {
    const neto = a-b;
    const nc = neto>0?'pos':neto<0?'neg':'zer';
    const sign = neto>0?'+':'';
    const ec = est==='Apertura'?'estado-apertura':'estado-activo';
    html += `<tr>
      <td><strong>${loc}</strong></td>
      <td class="${ec}">${est}</td>
      <td>${gz}</td>
      <td style="color:var(--muted)">${gr}</td>
      <td class="num-altas">${a}</td>
      <td class="num-bajas">${b}</td>
      <td class="num-neto ${nc}">${sign}${neto}</td>
    </tr>`;
  });
  html += '</tbody></table>';
  document.getElementById('table-locales').innerHTML = html;
}

// â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentTab = 'resumen';
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    currentTab = tab.dataset.tab;
    ['resumen','zonales','locales'].forEach(t => {
      document.getElementById('tab-'+t).style.display = t===currentTab ? '' : 'none';
    });
    renderCurrentTab();
  });
});

document.getElementById('search-locales').addEventListener('input', e => renderTable(e.target.value));

// â”€â”€ FULL REFRESH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderCurrentTab() {
  if (currentTab==='resumen')  renderTabResumen();
  if (currentTab==='zonales')  renderTabZonales();
  if (currentTab==='locales')  renderTable(document.getElementById('search-locales').value);
}

function refresh() {
  renderRegionalCards();
  updateKPIs();
  renderCurrentTab();
}

// INIT
refresh();
</script>
</body>
</html>
